<h2><%= @page_title %></h2>
<!-- <%= link_to 'Edit', edit_join_db_path(@join_db.id) %> -->
<div class="top-container" style="width: 100%; display: block; float: left">
    <div class="test" style="display: block; float: left; margin-right: 20px">
        <h3>Info</h3>
        <div class="infoTile" style="font-size: 1.2em">
            <%= render partial: 'join_dbs/info', locals: {join_db: @join_db} %>
        </div>
    </div>

    <div class="test" style="display: block; float: left">
        <h3>Add Connections</h3>
        <% if @join_db.provisioning? %>
            <p>You will be able to add connections here once your JoinDb is done provisioning (usually 4-5 minutes).</p>
        <% else %>
            <div class="infoTile">
                <p>
                <b>Database:</b>
                <br />
                <%= link_to 'Add Database', remote_dbs_new_path(join_db: @join_db.id), class: "button mainButton" %>
                </p>
                <p>
                <%= form_for @new_rdb do |f| %>
                    <%= f.label :add_csv, 'CSV:' %>
                    <%= f.file_field :csv, accept: 'text/csv' %>
                    <%= f.hidden_field :db_type, value: "csv" %>
                    <%= f.hidden_field :join_db_id, value: @join_db.id %>
                    <%= f.submit 'Add CSV', class: "button mainButton" %>
                <% end %>
                </p>
            </div>
        <% end %>
    </div>
</div>
<div>
<br />
<h3>Connections</h3>
<% @remote_dbs.each do |rdb| %>
    <div class="infoTile <%= rdb.db_type %>">
        <h4><%= rdb.name %></h4>
        <% if rdb.table_name or (not rdb.csv? and rdb.get_join_db_schema_name) %>
            <p>
                <em>In your JoinDb as: <%= rdb.csv? ? "table import.#{rdb.table_name}" : "schema #{rdb.get_join_db_schema_name.downcase}" %></em>
            </p>
        <% end %>
        <p>
        <%= button_to 'Refresh Schema', refresh_remote_db_path(rdb.id), method: :post, class: "button yellow" %>
        <br />
        <%= link_to 'Delete', delete_remote_db_path(rdb.id), {class: "deleteLink"} %>
        </p>
        <ul>
            <li>DB Type: <%= rdb.db_type %></li>
            <li>Host: <%= rdb.host %></li>
            <li>Port: <%= rdb.port %></li>
            <li>DB Name: <%= rdb.database_name %></li>
            <li>Schema: <%= rdb.schema %></li>
            <li>Username: <%= rdb.remote_user %></li>
        </ul>
    </div>
<% end %>
</div>